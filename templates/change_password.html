{% extends "base.html" %}

{% block title %}Change Password{% endblock %}

{% block content %}
<h2>Change Password</h2>

{% if error %}
    <p style="color: red; font-weight: bold;">{{ error }}</p>
{% endif %}
{% if success %}
    <p style="color: green; font-weight: bold;">{{ success }}</p>
{% endif %}

<form method="POST" class="form-wrap">

    <!-- Current Password -->
    <label>Current Password:</label><br>
    <div style="position: relative;">
        <input type="password" name="current" id="currentPass" required style="padding-right: 40px;">
        <span class="toggle-eye" onclick="togglePassword('currentPass', this)">
            👁
        </span>
    </div><br>

    <!-- New Password -->
    <label>New Password:</label><br>
    <div style="position: relative;">
        <input type="password" name="new" id="newPass" required style="padding-right: 40px;">
        <span class="toggle-eye" onclick="togglePassword('newPass', this)">
            👁
        </span>
    </div>
    <small id="strengthMsg" style="color: gray;">Must be at least 8 characters</small><br><br>

    <!-- Confirm New Password -->
    <label>Confirm New Password:</label><br>
    <div style="position: relative;">
        <input type="password" name="confirm" id="confirmPass" required style="padding-right: 40px;">
        <span class="toggle-eye" onclick="togglePassword('confirmPass', this)">
            👁
        </span>
    </div><br>

    <button type="submit">Update Password</button>
</form>

<style>
.toggle-eye {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
}
</style>

<script>
function togglePassword(fieldId, iconElem) {
    const input = document.getElementById(fieldId);
    if (input.type === "password") {
        input.type = "text";
        iconElem.textContent = "🙈";
    } else {
        input.type = "password";
        iconElem.textContent = "👁";
    }
}

// Password strength indicator
document.getElementById('newPass').addEventListener('input', function() {
    const msg = document.getElementById('strengthMsg');
    if (this.value.length >= 8) {
        msg.textContent = "✅ Strong enough";
        msg.style.color = "green";
    } else {
        msg.textContent = "❌ Too short";
        msg.style.color = "red";
    }
});
</script>
{% endblock %}
